---
title: 'Firefox でセキュリティ例外の承認ができない場合の対応方法'
date: Tue, 23 Jul 2013 10:39:22 +0000
draft: false
tags: ['firefox', 'TLS']
---

どういう場合に発生するのかは不明だが、Firefox で自己署名証明書の使われた SSL サイトにアクセスした際になぜか例外承認で「セキュリティ例外を承認」というボタンがグレーアウトして承認出来ず、そのサイトにアクセスできないという現象に遭遇することがあります。

{{< figure src="firefox-security-exception2.png" caption="セキュリティ例外を承認」ボタンがグレーアウト" >}}

有効な証明書だと言うくせに「セキュリティ例外を承認」ボタンがグレーアウトしていてアクセスさせてくれません...\[/caption\]

有効な証明書だって言ってるくせにぃ... ムキーッ

これまで、IE や Chrome で逃げて来ましたが、ちょっと調べてみることにしました。

簡単に結論を書くと、「キャッシュ」を消すことで承認できるようになります。

ブラウザ終了時に全部消してしまうようにするのが良いかもしれません。 「オプション」→「プライバシー」→「履歴」で『Firefox に「記憶させる履歴を詳細設定をする」』を選択し、「Firefox 終了時に履歴を消去する」にチェックを入れ、右の「設定」ボタンから消去する項目を選択します。消すことのできる履歴には幾つも項目がありますが、この問題では「キャッシュ」だけで良いです。

プライバシー設定から終了時にキャッシュを消す設定
{{< figure src="firefox-privacy-setting.png" caption="プライバシー設定" >}}

キャッシュを消すと承認できるようになりました
{{< figure src="firefox-security-exception1.png" caption="例外承認できる場合" >}}

承認時に「**次回以降もこの例外を有効にする**」のチェックを外してしまうと、次からグレーアウトしてしまうようです。昔のバージョンはそうでは無かったと思うのですが、いつからか変わってしまったようです。「次回以降もこの例外を有効にする」にチェックが入っていれば、「オプション」→「詳細」→「暗号化」→「証明書を表示」で、「サーバー証明書」の中にサーバー名、ポート番号とともに登録されます。消したくなったらここから消しましょう。

承認情報がキャッシュとして残ってしまうようになったために、同じ証明書をつかっているが別のホスト名（IPアドレス）という場合に、別のタブで同時にアクセスしたりすることができなくて不便になってしまいました。冗長化構成の機器で別々のIPアドレスだけど同じ証明書を使ってる管理画面が...

> あなたのサーバ証明書は認証局によって発行された他の証明書と同じシリアル番号を持っています。一意なシリアル番号を持つ新しい証明書を取得してください。 (エラーコード: sec\_error\_reused\_issuer\_and\_serial)

これはもう IE か Chrome で回避せざるを得ないようです。 ところで、ググってるときに↓こんなページを見つけたのですが [https://support.mozillamessaging.com/ja/kb/add-security-exception](https://support.mozillamessaging.com/ja/kb/add-security-exception)

> 代替手段として、セキュリティ例外を追加することができます。ただしこれは、Thunderbird とメールサーバとの通信が暗号化されないため、第三者に通信内容を盗み見られたり改ざんされたりする可能性があることに注意してください。

えーっ、うっそ～？暗号化されてるけど、相手が何者かわからないだけだよねぇ？？？ 英語のページを見ても "not encrypted" って書いてあるんだよね。ウムム... [https://support.mozillamessaging.com/en-US/kb/add-security-exception](https://support.mozillamessaging.com/en-US/kb/add-security-exception)
