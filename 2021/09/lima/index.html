<!doctype html><html lang=ja dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head>
<meta charset=utf-8>
<meta http-equiv=content-language content="ja">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>Lima で nerdctl &#183; 1Q77</title>
<meta name=title content="Lima で nerdctl &#183; 1Q77">
<link rel=canonical href=https://preview-blog.1q77.com/2021/09/lima/>
<link type=text/css rel=stylesheet href=/css/main.bundle.min.a9d40529d239a91ecb75447e67ee6c80c1f1c28593904b4052651b12220121e13ec42904268b0193a6858f039cf8bfdd2b1331529ed341ddc7488cec3bdcbc2e.css integrity="sha512-qdQFKdI5qR7LdUR+Z+5sgMHxwoWTkEtAUmUbEiIBIeE+xCkEJosBk6aFjwOc+L/dKxMxUp7TQd3HSIzsO9y8Lg==">
<script type=text/javascript src=/js/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg=="></script>
<script type=text/javascript src=/js/appearance.min.49025a779c36ad37a5bf9f1cc6bffd35ccb69ce15560ef1b10057ddf31576265b19f8bcc1733207336c9144926f7b18aea2e5895f29e858b24271332a2fa5cd5.js integrity="sha512-SQJad5w2rTelv58cxr/9Ncy2nOFVYO8bEAV93zFXYmWxn4vMFzMgczbJFEkm97GK6i5YlfKehYskJxMyovpc1Q=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.34ee8372ff77835535e486c6ed01ff6993374a1cec8108898cad793fc6ae7520778e24db68e085c762d25af6fa7d00b57d7a791438dc68b676581f8c8344f6e0.js integrity="sha512-NO6Dcv93g1U15IbG7QH/aZM3ShzsgQiJjK15P8audSB3jiTbaOCFx2LSWvb6fQC1fXp5FDjcaLZ2WB+Mg0T24A==" data-copy data-copied></script>
<script src=/js/zoom.min.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<meta property="og:title" content="Lima で nerdctl">
<meta property="og:description" content="Docker Desktop の代わりに docker cli + Minikube ってのを試しただけど、Kubernetes は docker を非推奨にしてるし、kubernetes は不要な場合は無駄が多いしなあ&">
<meta property="og:type" content="article">
<meta property="og:url" content="https://preview-blog.1q77.com/2021/09/lima/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-09-19T16:58:10+00:00">
<meta property="article:modified_time" content="2021-09-19T16:58:10+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Lima で nerdctl">
<meta name=twitter:description content="Docker Desktop の代わりに docker cli + Minikube ってのを試しただけど、Kubernetes は docker を非推奨にしてるし、kubernetes は不要な場合は無駄が多いしなあ&">
<script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Lima で nerdctl","headline":"Lima で nerdctl","abstract":"Docker Desktop の代わりに docker cli \u002b Minikube ってのを試しただけど、Kubernetes は docker を非推奨にしてるし、kubernetes は不要な場合は無駄が多いしなあ\u0026","inLanguage":"ja","url":"https:\/\/preview-blog.1q77.com\/2021\/09\/lima\/","author":{"@type":"Person","name":"Yoshinori Teraoka"},"copyrightYear":"2021","dateCreated":"2021-09-19T16:58:10\u002b00:00","datePublished":"2021-09-19T16:58:10\u002b00:00","dateModified":"2021-09-19T16:58:10\u002b00:00","keywords":["Docker","Docker"],"mainEntityOfPage":"true","wordCount":"3304"}]</script>
<meta name=author content="Yoshinori Teraoka">
<link href=https://twitter.com/yteraoka rel=me>
<link href=https://github.com/yteraoka rel=me>
<link href=https://linkedin.com/in/fa5b66b7-9c77-4e1b-8b97-40ba4a5a2c13/ rel=me>
<link href=https://medium.com/@yteraoka rel=me>
<link rel=stylesheet href=https://rsms.me/inter/inter.css>
</head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
<div id=the-top class="absolute flex self-center">
<a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>メインコンテンツへスキップ</a>
</div>
<div style=padding-left:0;padding-right:0 class="flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
<div class="flex flex-1 items-center justify-between">
<nav class="flex space-x-3">
<a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">1Q77</a>
</nav>
<div class="hidden md:flex items-center space-x-5 md:ml-12">
<a href=/posts/ class="text-base font-medium text-gray-500 hover:text-gray-900" title=Posts>
Blog
</a>
<a href=/tags/ class="text-base font-medium text-gray-500 hover:text-gray-900" title=Tags>
Tags
</a>
<a href=https://github.com/yteraoka class="text-base font-medium text-gray-500 hover:text-gray-900" title>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
&nbsp;
GitHub
</a>
<a href=https://twitter.com/yteraoka class="text-base font-medium text-gray-500 hover:text-gray-900" title>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
&nbsp;
Twitter
</a>
<a href=https://qiita.com/yteraoka class="text-base font-medium text-gray-500 hover:text-gray-900" title>
Qiita
</a>
<button id=search-button class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
</button>
<div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
<button id=appearance-switcher type=button>
<div class="flex items-center justify-center h-12 dark:hidden">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span>
</div>
<div class="items-center justify-center hidden h-12 dark:flex">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span>
</div>
</button>
</div>
</div>
<div class="flex md:hidden items-center space-x-5 md:ml-12">
<span></span>
<button id=search-button-mobile class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
</button>
<button id=appearance-switcher-mobile type=button style=margin-right:5px>
<div class="flex items-center justify-center h-12 dark:hidden">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span>
</div>
<div class="items-center justify-center hidden h-12 dark:flex">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span>
</div>
</button>
</div>
</div>
<div class="-my-2 -mr-2 md:hidden">
<label id=menu-button for=menu-controller class=block>
<input type=checkbox id=menu-controller class=hidden>
<div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg>
</span>
</div>
<div id=menu-wrapper style=padding-top:25px class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
<ul class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
<li class=mb-1>
<span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
</span>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>
Blog
</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>
Tags
</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://github.com/yteraoka title>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
&nbsp;
GitHub
</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://twitter.com/yteraoka title>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
&nbsp;
Twitter
</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://qiita.com/yteraoka title>
Qiita
</a>
</li>
</ul>
</div>
</label>
</div>
</div>
<div id=mobile-menu class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
<ul class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
<li class=mb-1>
<span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
</span>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>Blog</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://github.com/yteraoka title>GitHub</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://twitter.com/yteraoka title>Twitter</a>
</li>
<li class=mb-1>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://qiita.com/yteraoka title>Qiita</a>
</li>
<li>
<button id=search-button-mobile class="text-base hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
</button>
</li>
</ul>
</div>
<div class="relative flex flex-col grow">
<main id=main-content class=grow>
<article>
<header class=max-w-prose>
<ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
<li class="inline hidden">
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>1Q77</a><span class="px-1 text-primary-500">/</span>
</li>
<li class=inline>
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span>
</li>
<li class="inline hidden">
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/2021/09/lima/>Lima で nerdctl</a><span class="px-1 text-primary-500">/</span>
</li>
</ol>
<h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
Lima で nerdctl
</h1>
<div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2021-09-19 16:58:10 +0000 UTC">2021年9月19日</time>
</div>
<div class="flex flex-row flex-wrap items-center">
<span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/docker/")'>
<span class=flex>
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
Docker
</span>
</span>
</span>
</div>
</div>
</header>
<section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
<div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
<div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
<details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
<summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
目次
</summary>
<div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id=TableOfContents>
<ul>
<li><a href=#lima-のインストール>Lima のインストール</a></li>
<li><a href=#lima-virtual-machine-の起動>Lima Virtual Machine の起動</a></li>
<li><a href=#コンテナの実行>コンテナの実行</a></li>
<li><a href=#lima-virtual-machine-の停止>Lima Virtual Machine の停止</a></li>
<li><a href=#lima-virtual-machine-の削除>Lima Virtual Machine の削除</a></li>
<li><a href=#docker-エイリアス>docker エイリアス</a></li>
<li><a href=#docker-build--docker-push>docker build / docker push</a></li>
<li><a href=#docker-compose>docker-compose</a></li>
<li><a href=#まとめ>まとめ</a></li>
</ul>
</nav>
</div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
目次
</summary>
<div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id=TableOfContents>
<ul>
<li><a href=#lima-のインストール>Lima のインストール</a></li>
<li><a href=#lima-virtual-machine-の起動>Lima Virtual Machine の起動</a></li>
<li><a href=#コンテナの実行>コンテナの実行</a></li>
<li><a href=#lima-virtual-machine-の停止>Lima Virtual Machine の停止</a></li>
<li><a href=#lima-virtual-machine-の削除>Lima Virtual Machine の削除</a></li>
<li><a href=#docker-エイリアス>docker エイリアス</a></li>
<li><a href=#docker-build--docker-push>docker build / docker push</a></li>
<li><a href=#docker-compose>docker-compose</a></li>
<li><a href=#まとめ>まとめ</a></li>
</ul>
</nav>
</div>
</details>
</div>
</div>
<div class="min-w-0 min-h-0 max-w-prose">
<p><a href=/2021/09/replace-docker-desktop-with-minikube/>Docker Desktop の代わりに docker cli + Minikube</a> ってのを試しただけど、Kubernetes は docker を非推奨にしてるし、kubernetes は不要な場合は無駄が多いしなあ&mldr; ってことで <a href=https://github.com/lima-vm/lima>lima</a> も試してみる。</p>
<p>(2021/01/05 追記: <a href=/2022/01/docker-on-lima/>Docker on Lima</a> も見てね)</p>
<p>Lima は自動のファイル共有、ポートフォワード、containerd をサポートした仮想マシンを提供してくれるツール。Windows subsystem for Linux の mac 版とも言えるとドキュメントに書かれている。</p>
<p>今回は Intel Mac 環境で試しています。M1 Mac の場合は qemu に patch が必要みたいです。</p>
<h2 id=lima-のインストール class="relative group">Lima のインストール <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#lima-%e3%81%ae%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab aria-label=アンカー>#</a></span></h2>
<p><a href=https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/lima.rb>Homebrew</a> でインストール</p>
<pre tabindex=0><code>$ brew install lima
</code></pre><h2 id=lima-virtual-machine-の起動 class="relative group">Lima Virtual Machine の起動 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#lima-virtual-machine-%e3%81%ae%e8%b5%b7%e5%8b%95 aria-label=アンカー>#</a></span></h2>
<p><code>limactl</code> コマンドを使う</p>
<pre tabindex=0><code>$ limactl
NAME:
   limactl - Lima: Linux virtual machines

USAGE:
   limactl [global options] command [command options] [arguments...]

VERSION:
   0.6.4

COMMANDS:
   start               Start an instance of Lima. If the instance does not exist, open an editor for creating new one, with name &quot;default&quot;
   stop                Stop an instance
   shell               Execute shell in Lima
   copy, cp            Copy files between host and guest
   list, ls            List instances of Lima.
   delete, remove, rm  Delete an instance of Lima.
   validate            Validate yaml files
   prune               Prune garbage objects
   completion          Show shell completion
   help, h             Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --debug        debug mode (default: false)
   --help, -h     show help (default: false)
   --version, -v  print the version (default: false)
</code></pre><p><code>limactl start</code> だけで実行するとインタラクティブなメニュー表示になった。とりあえず &ldquo;Proceed with the default configuration&rdquo; で Enter</p>
<pre tabindex=0><code>$ limactl start
? Creating an instance &quot;default&quot;  [Use arrows to move, type to filter]
&gt; Proceed with the default configuration
  Open an editor to override the configuration
  Exit
</code></pre><p>nerdctl のダウンロードが始まりました。(GitHub からのダウンロードが遅い&mldr;)</p>
<pre tabindex=0><code>$ limactl start
? Creating an instance &quot;default&quot; Proceed with the default configuration
INFO[0096] Downloading &quot;https://github.com/containerd/nerdctl/releases/download/v0.11.2/nerdctl-full-0.11.2-linux-amd64.tar.gz&quot; (sha256:27dbb238f9eb248ca68f11b412670db51db84905e3583834400305b2149915f2) 
3.69 MiB / 174.89 MiB [&gt;____________________________________] 2.11% 149.75 KiB/s
</code></pre><p>暇なので関連ファイルを探してみたら <code>~/.lima</code> ディレクトリに作成されていました。</p>
<pre tabindex=0><code>$ find .lima -type f
.lima/default/lima.yaml
.lima/_config/user
.lima/_config/user.pub
</code></pre><p><code>default/lima.yaml</code> が default というデフォルト仮想マシンの設定ファイルっぽいです。中身は次のようになっていました。ふむふむ、なるほどって感じですね。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w></span><span class=c># BASIC CONFIGURATION</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Arch: &#34;default&#34;, &#34;x86_64&#34;, &#34;aarch64&#34;.</span><span class=w>
</span><span class=w></span><span class=c># &#34;default&#34; corresponds to the host architecture.</span><span class=w>
</span><span class=w></span><span class=nt>arch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;default&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># An image must support systemd and cloud-init.</span><span class=w>
</span><span class=w></span><span class=c># Ubuntu and Fedora are known to work.</span><span class=w>
</span><span class=w></span><span class=c># Default: none (must be specified)</span><span class=w>
</span><span class=w></span><span class=nt>images</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># Try to use a local image first.</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;~/Downloads/hirsute-server-cloudimg-amd64.img&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>arch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;x86_64&#34;</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;~/Downloads/hirsute-server-cloudimg-arm64.img&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>arch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;aarch64&#34;</span><span class=w>
</span><span class=w>
</span><span class=w>  </span><span class=c># Download the file from the internet when the local file is missing.</span><span class=w>
</span><span class=w>  </span><span class=c># Hint: run `limactl prune` to invalidate the &#34;current&#34; cache</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://cloud-images.ubuntu.com/hirsute/current/hirsute-server-cloudimg-amd64.img&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>arch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;x86_64&#34;</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://cloud-images.ubuntu.com/hirsute/current/hirsute-server-cloudimg-arm64.img&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>arch</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;aarch64&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># CPUs: if you see performance issues, try limiting cpus to 1.</span><span class=w>
</span><span class=w></span><span class=c># Default: 4</span><span class=w>
</span><span class=w></span><span class=nt>cpus</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Memory size</span><span class=w>
</span><span class=w></span><span class=c># Default: &#34;4GiB&#34;</span><span class=w>
</span><span class=w></span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4GiB&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Disk size</span><span class=w>
</span><span class=w></span><span class=c># Default: &#34;100GiB&#34;</span><span class=w>
</span><span class=w></span><span class=nt>disk</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;100GiB&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Expose host directories to the guest, the mount point might be accessible from all UIDs in the guest</span><span class=w>
</span><span class=w></span><span class=c># Default: none</span><span class=w>
</span><span class=w></span><span class=nt>mounts</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;~&#34;</span><span class=w>
</span><span class=w>    </span><span class=c># CAUTION: `writable` SHOULD be false for the home directory.</span><span class=w>
</span><span class=w>    </span><span class=c># Setting `writable` to true is possible, but untested and dangerous.</span><span class=w>
</span><span class=w>    </span><span class=nt>writable</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>  </span>- <span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/tmp/lima&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>writable</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>ssh</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># A localhost port of the host. Forwarded to port 22 of the guest.</span><span class=w>
</span><span class=w>  </span><span class=c># Currently, this port number has to be specified manually.</span><span class=w>
</span><span class=w>  </span><span class=c># Default: none</span><span class=w>
</span><span class=w>  </span><span class=nt>localPort</span><span class=p>:</span><span class=w> </span><span class=m>60022</span><span class=w>
</span><span class=w>  </span><span class=c># Load ~/.ssh/*.pub in addition to $LIMA_HOME/_config/user.pub .</span><span class=w>
</span><span class=w>  </span><span class=c># This option is useful when you want to use other SSH-based</span><span class=w>
</span><span class=w>  </span><span class=c># applications such as rsync with the Lima instance.</span><span class=w>
</span><span class=w>  </span><span class=c># If you have an insecure key under ~/.ssh, do not use this option.</span><span class=w>
</span><span class=w>  </span><span class=c># Default: true</span><span class=w>
</span><span class=w>  </span><span class=nt>loadDotSSHPubKeys</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>
</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w></span><span class=c># ADVANCED CONFIGURATION</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>containerd</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># Enable system-wide (aka rootful)  containerd and its dependencies (BuildKit, Stargz Snapshotter)</span><span class=w>
</span><span class=w>  </span><span class=c># Default: false</span><span class=w>
</span><span class=w>  </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>  </span><span class=c># Enable user-scoped (aka rootless) containerd and its dependencies</span><span class=w>
</span><span class=w>  </span><span class=c># Default: true</span><span class=w>
</span><span class=w>  </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Provisioning scripts need to be idempotent because they might be called</span><span class=w>
</span><span class=w></span><span class=c># multiple times, e.g. when the host VM is being restarted.</span><span class=w>
</span><span class=w></span><span class=c># provision:</span><span class=w>
</span><span class=w></span><span class=c>#   # `system` is executed with the root privilege</span><span class=w>
</span><span class=w></span><span class=c>#   - mode: system</span><span class=w>
</span><span class=w></span><span class=c>#     script: |</span><span class=w>
</span><span class=w></span><span class=c>#       #!/bin/bash</span><span class=w>
</span><span class=w></span><span class=c>#       set -eux -o pipefail</span><span class=w>
</span><span class=w></span><span class=c>#       export DEBIAN_FRONTEND=noninteractive</span><span class=w>
</span><span class=w></span><span class=c>#       apt-get install -y vim</span><span class=w>
</span><span class=w></span><span class=c>#   # `user` is executed without the root privilege</span><span class=w>
</span><span class=w></span><span class=c>#   - mode: user</span><span class=w>
</span><span class=w></span><span class=c>#     script: |</span><span class=w>
</span><span class=w></span><span class=c>#       #!/bin/bash</span><span class=w>
</span><span class=w></span><span class=c>#       set -eux -o pipefail</span><span class=w>
</span><span class=w></span><span class=c>#       cat &lt; ~/.vimrc</span><span class=w>
</span><span class=w></span><span class=c>#       set number</span><span class=w>
</span><span class=w></span><span class=c>#       EOF</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># probes:</span><span class=w>
</span><span class=w></span><span class=c>#  # Only `readiness` probes are supported right now.</span><span class=w>
</span><span class=w></span><span class=c>#  - mode: readiness</span><span class=w>
</span><span class=w></span><span class=c>#    description: vim to be installed</span><span class=w>
</span><span class=w></span><span class=c>#    script: |</span><span class=w>
</span><span class=w></span><span class=c>#       #!/bin/bash</span><span class=w>
</span><span class=w></span><span class=c>#       set -eux -o pipefail</span><span class=w>
</span><span class=w></span><span class=c>#       if ! timeout 30s bash -c &#34;until command -v vim; do sleep 3; done&#34;; then</span><span class=w>
</span><span class=w></span><span class=c>#         echo &gt;&amp;2 &#34;vim is not installed yet&#34;</span><span class=w>
</span><span class=w></span><span class=c>#         exit 1</span><span class=w>
</span><span class=w></span><span class=c>#       fi</span><span class=w>
</span><span class=w></span><span class=c>#    hint: |</span><span class=w>
</span><span class=w></span><span class=c>#      vim was not installed in the guest. Make sure the package system is working correctly.</span><span class=w>
</span><span class=w></span><span class=c>#      Also see &#34;/var/log/cloud-init-output.log&#34; in the guest.</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w></span><span class=c># FURTHER ADVANCED CONFIGURATION</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>firmware</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># Use legacy BIOS instead of UEFI.</span><span class=w>
</span><span class=w>  </span><span class=c># Default: false</span><span class=w>
</span><span class=w>  </span><span class=nt>legacyBIOS</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>video</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># QEMU display, e.g., &#34;none&#34;, &#34;cocoa&#34;, &#34;sdl&#34;.</span><span class=w>
</span><span class=w>  </span><span class=c># As of QEMU v5.2, enabling this is known to have negative impact</span><span class=w>
</span><span class=w>  </span><span class=c># on performance on macOS hosts: https://gitlab.com/qemu-project/qemu/-/issues/334</span><span class=w>
</span><span class=w>  </span><span class=c># Default: &#34;none&#34;</span><span class=w>
</span><span class=w>  </span><span class=nt>display</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;none&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>network</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># The instance can get routable IP addresses from the vmnet framework using</span><span class=w>
</span><span class=w>  </span><span class=c># https://github.com/lima-vm/vde_vmnet. Both vde_switch and vde_vmnet</span><span class=w>
</span><span class=w>  </span><span class=c># daemons must be running before the instance is started. The interface type</span><span class=w>
</span><span class=w>  </span><span class=c># (host, shared, or bridged) is configured in vde_vmnet and not lima.</span><span class=w>
</span><span class=w>  </span><span class=nt>vde</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=c># vnl (virtual network locator) points to the vde_switch socket directory,</span><span class=w>
</span><span class=w>    </span><span class=c># optionally with vde:// prefix</span><span class=w>
</span><span class=w>    </span><span class=c># - vnl: &#34;vde:///var/run/vde.ctl&#34;</span><span class=w>
</span><span class=w>    </span><span class=c>#   # VDE Switch port number (not TCP/UDP port number). Set to 65535 for PTP mode.</span><span class=w>
</span><span class=w>    </span><span class=c>#   # Default: 0</span><span class=w>
</span><span class=w>    </span><span class=c>#   switchPort: 0</span><span class=w>
</span><span class=w>    </span><span class=c>#   # MAC address of the instance; lima will pick one based on the instance name,</span><span class=w>
</span><span class=w>    </span><span class=c>#   # so DHCP assigned ip addresses should remain constant over instance restarts.</span><span class=w>
</span><span class=w>    </span><span class=c>#   macAddress: &#34;&#34;</span><span class=w>
</span><span class=w>    </span><span class=c>#   # Interface name, defaults to &#34;vde0&#34;, &#34;vde1&#34;, etc.</span><span class=w>
</span><span class=w>    </span><span class=c>#   name: &#34;&#34;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Port forwarding rules. Forwarding between ports 22 and ssh.localPort cannot be overridden.</span><span class=w>
</span><span class=w></span><span class=c># Rules are checked sequentially until the first one matches.</span><span class=w>
</span><span class=w></span><span class=c># portForwards:</span><span class=w>
</span><span class=w></span><span class=c>#   - guestPort: 443</span><span class=w>
</span><span class=w></span><span class=c>#     hostIP: &#34;0.0.0.0&#34; # overrides the default value &#34;127.0.0.1&#34;; allows privileged port forwarding</span><span class=w>
</span><span class=w></span><span class=c>#   # default: hostPort: 443 (same as guestPort)</span><span class=w>
</span><span class=w></span><span class=c>#   # default: guestIP: &#34;127.0.0.1&#34; (also matches bind addresses &#34;0.0.0.0&#34;, &#34;::&#34;, and &#34;::1&#34;)</span><span class=w>
</span><span class=w></span><span class=c>#   # default: proto: &#34;tcp&#34; (only valid value right now)</span><span class=w>
</span><span class=w></span><span class=c>#   - guestPortRange: [4000, 4999]</span><span class=w>
</span><span class=w></span><span class=c>#     hostIP:  &#34;0.0.0.0&#34; # overrides the default value &#34;127.0.0.1&#34;</span><span class=w>
</span><span class=w></span><span class=c>#   # default: hostPortRange: [4000, 4999] (must specify same number of ports as guestPortRange)</span><span class=w>
</span><span class=w></span><span class=c>#   - guestPort: 80</span><span class=w>
</span><span class=w></span><span class=c>#     hostPort: 8080 # overrides the default value 80</span><span class=w>
</span><span class=w></span><span class=c>#   - guestIP: &#34;127.0.0.2&#34; # overrides the default value &#34;127.0.0.1&#34;</span><span class=w>
</span><span class=w></span><span class=c>#     hostIP: &#34;127.0.0.2&#34; # overrides the default value &#34;127.0.0.1&#34;</span><span class=w>
</span><span class=w></span><span class=c>#   # default: guestPortRange: [1024, 65535]</span><span class=w>
</span><span class=w></span><span class=c>#   # default: hostPortRange: [1024, 65535]</span><span class=w>
</span><span class=w></span><span class=c>#   - guestPort: 8888</span><span class=w>
</span><span class=w></span><span class=c>#     ignore: true (don&#39;t forward this port)</span><span class=w>
</span><span class=w></span><span class=c>#   # Lima internally appends this fallback rule at the end:</span><span class=w>
</span><span class=w></span><span class=c>#   - guestIP: &#34;127.0.0.1&#34;</span><span class=w>
</span><span class=w></span><span class=c>#     guestPortRange: [1024, 65535]</span><span class=w>
</span><span class=w></span><span class=c>#     hostIP: &#34;127.0.0.1&#34;</span><span class=w>
</span><span class=w></span><span class=c>#     hostPortRange: [1024, 65535]</span><span class=w>
</span><span class=w></span><span class=c>#   # Any port still not matched by a rule will not be forwarded (ignored)</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Extra environment variables that will be loaded into the VM at start up.</span><span class=w>
</span><span class=w></span><span class=c># These variables are currently only consumed by internal init scripts, not by the user shell.</span><span class=w>
</span><span class=w></span><span class=c># This field is experimental and may change in a future release of Lima.</span><span class=w>
</span><span class=w></span><span class=c># https://github.com/lima-vm/lima/pull/200</span><span class=w>
</span><span class=w></span><span class=c># env:</span><span class=w>
</span><span class=w></span><span class=c>#   KEY: value</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># Explicitly set DNS addresses for qemu user-mode networking. By default qemu picks *one*</span><span class=w>
</span><span class=w></span><span class=c># nameserver from the host config and forwards all queries to this server. On macOS</span><span class=w>
</span><span class=w></span><span class=c># Lima adds the nameservers configured for the &#34;en0&#34; interface to the list. In case this</span><span class=w>
</span><span class=w></span><span class=c># still doesn&#39;t work (e.g. VPN setups), the servers can be specified here explicitly.</span><span class=w>
</span><span class=w></span><span class=c># If nameservers are specified here, then the &#34;en0&#34; configuration will be ignored.</span><span class=w>
</span><span class=w></span><span class=c># dns:</span><span class=w>
</span><span class=w></span><span class=c># - 1.1.1.1</span><span class=w>
</span><span class=w></span><span class=c># - 1.0.0.1</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== #</span><span class=w>
</span><span class=w></span><span class=c># END OF TEMPLATE</span><span class=w>
</span><span class=w></span><span class=c># ===================================================================== # </span><span class=w>
</span></code></pre></div><p>nerdctl のダウンロードが終わったら仮想マシンイメージのダウンロードが始まりました。こっちは速い。それが終わると仮想マシンの起動が始まりました。</p>
<pre tabindex=0><code>$ limactl start
? Creating an instance &quot;default&quot; Proceed with the default configuration
INFO[0096] Downloading &quot;https://github.com/containerd/nerdctl/releases/download/v0.11.2/nerdctl-full-0.11.2-linux-amd64.tar.gz&quot;(sha256:27dbb238f9eb248ca68f11b412670db51db84905e3583834400305b2149915f2)
174.89 MiB / 174.89 MiB [---------------------------------] 100.00% 150.72 KiB/s
INFO[1286] Downloaded &quot;nerdctl-full-0.11.2-linux-amd64.tar.gz&quot;
INFO[1287] Attempting to download the image from &quot;~/Downloads/hirsute-server-cloudimg-amd64.img&quot;
INFO[1287] Attempting to download the image from &quot;https://cloud-images.ubuntu.com/hirsute/current/hirsute-server-cloudimg-amd64.img&quot;
558.00 MiB / 558.00 MiB [-----------------------------------] 100.00% 7.57 MiB/s
INFO[1362] Downloaded image from &quot;https://cloud-images.ubuntu.com/hirsute/current/hirsute-server-cloudimg-amd64.img&quot;
INFO[1366] [hostagent] Starting QEMU (hint: to watch the boot progress, see &quot;/Users/teraoka/.lima/default/serial.log&quot;)
INFO[1366] SSH Local Port: 60022
INFO[1366] [hostagent] Waiting for the essential requirement 1 of 4: &quot;ssh&quot;
INFO[1394] [hostagent] Waiting for the essential requirement 1 of 4: &quot;ssh&quot;
INFO[1395] [hostagent] The essential requirement 1 of 4 is satisfied
INFO[1395] [hostagent] Waiting for the essential requirement 2 of 4: &quot;sshfs binary to be installed&quot;
INFO[1416] [hostagent] The essential requirement 2 of 4 is satisfied
INFO[1416] [hostagent] Waiting for the essential requirement 3 of 4: &quot;/etc/fuse.conf to contain \&quot;user_allow_other\&quot;&quot;
INFO[1431] [hostagent] The essential requirement 3 of 4 is satisfied
INFO[1431] [hostagent] Waiting for the essential requirement 4 of 4: &quot;the guest agent to be running&quot;
INFO[1431] [hostagent] The essential requirement 4 of 4 is satisfied
INFO[1431] [hostagent] Mounting &quot;/Users/teraoka&quot;
INFO[1432] [hostagent] Mounting &quot;/tmp/lima&quot;
INFO[1432] [hostagent] Waiting for the optional requirement 1 of 2: &quot;systemd must be available&quot;
INFO[1433] [hostagent] Forwarding &quot;/run/user/501/lima-guestagent.sock&quot; (guest) to &quot;/Users/teraoka/.lima/default/ga.sock&quot; (host)
INFO[1433] [hostagent] Not forwarding TCP 127.0.0.53:53
INFO[1433] [hostagent] Not forwarding TCP 0.0.0.0:22
INFO[1433] [hostagent] Not forwarding TCP [::]:22
INFO[1433] [hostagent] The optional requirement 1 of 2 is satisfied
INFO[1433] [hostagent] Waiting for the optional requirement 2 of 2: &quot;containerd binaries to be installed&quot;
INFO[1433] [hostagent] The optional requirement 2 of 2 is satisfied
INFO[1433] READY. Run `lima` to open the shell.

</code></pre><p>この状態で <code>lima</code> と実行するだけで Linux VM 内の shell に入ります。</p>
<pre tabindex=0><code>$ lima
teraoka@lima-default:/Users/teraoka$ uname -a
Linux lima-default 5.11.0-34-generic #36-Ubuntu SMP Thu Aug 26 19:22:09 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
</code></pre><p>OS は Ubuntu ですね。systemd で各種サービスが起動されています。</p>
<pre tabindex=0><code>teraoka@lima-default:/Users/teraoka$ cat /etc/os-release
NAME=&quot;Ubuntu&quot;
VERSION=&quot;21.04 (Hirsute Hippo)&quot;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&quot;Ubuntu 21.04&quot;
VERSION_ID=&quot;21.04&quot;
HOME_URL=&quot;https://www.ubuntu.com/&quot;
SUPPORT_URL=&quot;https://help.ubuntu.com/&quot;
BUG_REPORT_URL=&quot;https://bugs.launchpad.net/ubuntu/&quot;
PRIVACY_POLICY_URL=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;
VERSION_CODENAME=hirsute
UBUNTU_CODENAME=hirsute

</code></pre><p>ホームディレクトリと /tmp/lima が sshfs でマウントされています。ホームディレクトリは Read-Only です。どこをどこにマウントするかや、Read-Write を許可するかどうかは lima.yaml で指定可能っぽいです。</p>
<pre tabindex=0><code>teraoka@lima-default:/Users/teraoka$ df -h
Filesystem       Size  Used Avail Use% Mounted on
tmpfs            393M  1.1M  392M   1% /run
/dev/vda1         97G  1.9G   95G   2% /
tmpfs            2.0G     0  2.0G   0% /dev/shm
tmpfs            5.0M     0  5.0M   0% /run/lock
tmpfs            4.0M     0  4.0M   0% /sys/fs/cgroup
/dev/vda15       105M  5.2M  100M   5% /boot/efi
/dev/sr0         182M  182M     0 100% /mnt/lima-cidata
tmpfs            393M  8.0K  393M   1% /run/user/501
:/Users/teraoka  466G  305G  143G  69% /Users/teraoka
:/tmp/lima       466G  305G  143G  69% /tmp/lima
</code></pre><p><code>/etc/hosts</code> を確認したら <code>192.168.5.2 host.lima.internal</code> という行がありました。Host (Mac) へのアクセスに使えそうです。</p>
<p>lima コマンドの引数に linux のコマンドを渡せばそのまま Linux 内で実行されます。</p>
<pre tabindex=0><code>$ lima uname -a
Linux lima-default 5.11.0-34-generic #36-Ubuntu SMP Thu Aug 26 19:22:09 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
</code></pre><h2 id=コンテナの実行 class="relative group">コンテナの実行 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%82%b3%e3%83%b3%e3%83%86%e3%83%8a%e3%81%ae%e5%ae%9f%e8%a1%8c aria-label=アンカー>#</a></span></h2>
<p>nerdctl も Linux 内にあります。次のようにしてコンテナの実行が可能。</p>
<pre tabindex=0><code>$ lima nerdctl run -d --name nginx -p 127.0.0.1:8080:80 nginx:alpine
</code></pre><pre tabindex=0><code>$ lima nerdctl ps
CONTAINER ID    IMAGE                             COMMAND                   CREATED               STATUS    PORTS                     NAMES
1230bf478818    docker.io/library/nginx:alpine    &quot;/docker-entrypoint.…&quot;    About a minute ago    Up        127.0.0.1:8080-&gt;80/tcp    nginx

</code></pre><p>この状態で Mac から localhost:8080 にアクセスすると nginx にアクセスできます。<code>~/.lima/default/lima.yaml</code> に portForwarding 設定がありましたが、これはあれとは別物のようです。nerdctl で指定したポートでアクセスできます。</p>
<pre tabindex=0><code>$ curl -s http://localhost:8080/
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h2 id=lima-virtual-machine-の停止 class="relative group">Lima Virtual Machine の停止 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#lima-virtual-machine-%e3%81%ae%e5%81%9c%e6%ad%a2 aria-label=アンカー>#</a></span></h2>
<pre tabindex=0><code>$ limactl stop
INFO[0000] Sending SIGINT to hostagent process 18940    
INFO[0000] Waiting for the host agent and the qemu processes to shut down 
INFO[0000] [hostagent] Received SIGINT, shutting down the host agent 
INFO[0000] [hostagent] Shutting down the host agent     
INFO[0000] [hostagent] Unmounting &quot;/Users/teraoka&quot;      
INFO[0000] [hostagent] Unmounting &quot;/tmp/lima&quot;           
WARN[0000] [hostagent] connection to the guest agent was closed unexpectedly 
INFO[0000] [hostagent] Shutting down QEMU with ACPI     
INFO[0000] [hostagent] Sending QMP system_powerdown command 
INFO[0001] [hostagent] QEMU has exited
</code></pre><pre tabindex=0><code>$ limactl ls
NAME       STATUS     SSH                ARCH      DIR
default    Stopped    127.0.0.1:60022    x86_64    /Users/teraoka/.lima/default
</code></pre><p><code>limactl start</code> で再度起動させることができます。コンテナイメージや停止状態のコンテナは残っています。</p>
<h2 id=lima-virtual-machine-の削除 class="relative group">Lima Virtual Machine の削除 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#lima-virtual-machine-%e3%81%ae%e5%89%8a%e9%99%a4 aria-label=アンカー>#</a></span></h2>
<p>削除の場合は仮想マシン名が省略できず、<code>default</code> も明示する必要がありました。</p>
<pre tabindex=0><code>$ limactl delete default
INFO[0000] The QEMU process seems already stopped       
INFO[0000] The host agent process seems already stopped 
INFO[0000] Removing *.pid *.sock under &quot;/Users/teraoka/.lima/default&quot; 
INFO[0000] Removing &quot;/Users/teraoka/.lima/default/ga.sock&quot; 
INFO[0000] Deleted &quot;default&quot; (&quot;/Users/teraoka/.lima/default&quot;)
</code></pre><p><code>limactl prune</code> では cache が消されるっぽい。ここにはダウンロードした nerdctl や仮想マシンイメージがあり、消してしまうと limactl delete 後に再度 limactl start を実行するとまたダウンロードからやり直しです。</p>
<pre tabindex=0><code>$ limactl prune
INFO[0000] Pruning &quot;/Users/teraoka/Library/Caches/lima&quot;
</code></pre><h2 id=docker-エイリアス class="relative group">docker エイリアス <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#docker-%e3%82%a8%e3%82%a4%e3%83%aa%e3%82%a2%e3%82%b9 aria-label=アンカー>#</a></span></h2>
<p>shell の alias を設定することでほぼ docker として使えるようです。</p>
<pre tabindex=0><code>alias docker=&quot;lima nerdctl&quot;
</code></pre><p>ひとつ、非互換に気づいた。nerdctl では <code>run</code> で <code>-d</code> と <code>--rm</code> が同時に使えない。ゴミを残したくないからよく使うんだけどなあ。</p>
<pre tabindex=0><code>$ lima nerdctl run -d --rm -p 8080:80 nginx:alpine
FATA[0000] flag -d and --rm cannot be specified together 
exit status 1
</code></pre><h2 id=docker-build--docker-push class="relative group">docker build / docker push <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#docker-build--docker-push aria-label=アンカー>#</a></span></h2>
<p>lima コマンド実行時の working dictory が仮想マシン内にも引き継がれるのでホームディレクトリ配下であれば <code>docker build -t xxx .</code> と実行しても、仮想マシン内の同じディレクトリで実行されるので　build が可能となっているようだ。</p>
<p><code>docker login</code> (<code>nerdctl login</code>) も当然仮想マシン内でログインするのだが、<code>/Users/teraoka</code> は Read-Only だし、Linux でのホームディレクトリは <code>/home/teraoka.linux</code> になっており、ログイン情報は <code>/home/teraoka.linux/.docker/config.json</code> に書かれます。keychain は使えない。</p>
<p>ログインしてしまえば docker push も可能です。</p>
<h2 id=docker-compose class="relative group">docker-compose <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#docker-compose aria-label=アンカー>#</a></span></h2>
<p>試していませんが nerdctl には compose サブコマンドがあります。</p>
<pre tabindex=0><code>$ lima nerdctl compose
NAME:
   nerdctl compose - Compose

USAGE:
   nerdctl compose command [command options] [arguments...]

COMMANDS:
   up       Create and start containers
   logs     View output from containers.
   build    Build or rebuild services
   down     Remove containers and associated resources
   help, h  Shows a list of commands or help for one command

OPTIONS:
   --file value, -f value          Specify an alternate compose file
   --project-directory value       Specify an alternate working directory
   --project-name value, -p value  Specify an alternate project name
   --env-file value                Specify an alternate environment file
   --help, -h                      show help (default: false)
</code></pre><p>次のようにして使えるようです。本家 docker-compose も新しいバージョンは docker のサブコマンドになっていますね。</p>
<pre tabindex=0><code>$ lima nerdctl compose -f ./examples/compose-wordpress/docker-compose.yaml up

</code></pre><p>nerdctl の <a href=https://github.com/containerd/nerdctl>GitHub repository</a> に <a href=https://github.com/containerd/nerdctl/tree/master/examples/compose-wordpress>example</a> があります。</p>
<h2 id=まとめ class="relative group">まとめ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%81%be%e3%81%a8%e3%82%81 aria-label=アンカー>#</a></span></h2>
<p>Minikube や Docker Desktop との違いとして nerdctl コマンドは Linux 仮想マシン内にあるというところが大きいですね。ここを意識できていればまずまず使えるんじゃないでしょうか。</p>
<p>Docker Desktop の volume mount 機能は便利ですね。</p>
</div>
<script>var liked_article=!1,oid,id,viewed,oid_likes,id_likes,liked;typeof auth!='undefined'&&(oid="views_posts/lima.md",id=oid&&oid.replaceAll("/","-"),viewed=localStorage.getItem(id),viewed||auth.signInAnonymously().then(()=>{var a=db.collection('views').doc(id);localStorage.setItem(id,!0),a.get().then(a=>{a.exists?db.collection('views').doc(id).update({views:firebase.firestore.FieldValue.increment(1)}):db.collection('views').doc(id).set({views:1})}).catch(a=>{console.log("Error getting document:",a)})}).catch(a=>{var b=a.code,c=a.message;console.error(b,c)}),oid_likes="likes_posts/lima.md",id_likes=oid_likes&&oid_likes.replaceAll("/","-"),liked=localStorage.getItem(id_likes),liked&&(liked_article=!0,document.querySelectorAll("button[id='likes_button']")[0].innerText="Remove Like"));function like_article(a){console.log("add"),liked_article=!0,localStorage.setItem(a,!0),document.querySelectorAll("button[id='likes_button']")[0].innerText="Remove Like",auth.signInAnonymously().then(()=>{var b=db.collection('likes').doc(a);b.get().then(b=>{b.exists?db.collection('likes').doc(a).update({likes:firebase.firestore.FieldValue.increment(1)}):db.collection('likes').doc(a).set({likes:1})}).catch(a=>{console.log("Error getting document:",a)})}).catch(a=>{var b=a.code,c=a.message;console.error(b,c)})}function remove_like_article(a){console.log("remove"),liked_article=!1,localStorage.setItem(a,!1),document.querySelectorAll("button[id='likes_button']")[0].innerText="Like",auth.signInAnonymously().then(()=>{var b=db.collection('likes').doc(a);b.get().then(b=>{b.exists?db.collection('likes').doc(a).update({likes:firebase.firestore.FieldValue.increment(-1)}):db.collection('likes').doc(a).set({likes:0})}).catch(a=>{console.log("Error getting document:",a)})}).catch(a=>{var b=a.code,c=a.message;console.error(b,c)})}function process_article(){var a="likes_posts/lima.md",b=a&&a.replaceAll("/","-");liked_article?remove_like_article(b):like_article(b)}</script>
</section>
<footer class="pt-8 max-w-prose print:hidden">
<div class=flex>
<div class=place-self-center>
<div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
著者
</div>
<div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
Yoshinori Teraoka
</div>
<div class="text-2xl sm:text-lg">
<div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/yteraoka target=_blank aria-label=Twitter rel="me noopener noreferrer">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
</a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/yteraoka target=_blank aria-label=Github rel="me noopener noreferrer">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
</a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/fa5b66b7-9c77-4e1b-8b97-40ba4a5a2c13/ target=_blank aria-label=Linkedin rel="me noopener noreferrer">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
</a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://medium.com/@yteraoka target=_blank aria-label=Medium rel="me noopener noreferrer">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M180.5 74.262C80.813 74.262.0 155.633.0 256S80.819 437.738 180.5 437.738 361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845.0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559C559 161.5 518.6 84.908 468.752 84.908zm139.506 17.821c-17.526.0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
</span>
</a>
</div>
</div>
</div>
</div>
<section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
<a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&url=https://preview-blog.1q77.com/2021/09/lima/&title=Lima%20%e3%81%a7%20nerdctl" title=LinkedInでシェアする aria-label=LinkedInでシェアする>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
</a>
<a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://preview-blog.1q77.com/2021/09/lima/&text=Lima%20%e3%81%a7%20nerdctl" title=Twitterに投稿する aria-label=Twitterに投稿する>
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
</a>
</section>
<div class=pt-8>
<hr class="border-dotted border-neutral-300 dark:border-neutral-600">
<div class="flex justify-between pt-3">
<span>
<a class="flex group" href=/2021/09/replace-docker-desktop-with-minikube/>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Docker Desktop の代わりに Minikube を使ってみる</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2021-09-18 16:07:27 +0000 UTC">2021年9月18日</time>
</span>
</span>
</a>
</span>
<span>
<a class="flex text-right group" href=/2021/09/podman-on-mac/>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">mac で podman</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2021-09-23 14:20:51 +0000 UTC">2021年9月23日</time>
</span>
</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
</a>
</span>
</div>
</div>
</footer>
</article>
<div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
<a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=TOPへスクロール title=TOPへスクロール>
&uarr;
</a>
</div>
</main><footer class="py-10 print:hidden">
<div class="flex items-center justify-between">
<p class="text-sm text-neutral-500 dark:text-neutral-400">
&copy;
2022
Yoshinori Teraoka
</p>
</div>
<script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:'rgba(0,0,0,0.5)',scrollOffset:0})</script>
<script type=text/javascript src=/js/process.min.48d08339b8a087b59c7b8cb42b6717aeeed3e07bfc68b1654cac27f00583284dac59cae47fb686dd7c0e9ff1d2745689dc2071230dff432ca6d7fc24b9f2e036.js integrity="sha512-SNCDObigh7Wce4y0K2cXru7T4Hv8aLFlTKwn8AWDKE2sWcrkf7aG3XwOn/HSdFaJ3CBxIw3/Qyym1/wkufLgNg=="></script>
</footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://preview-blog.1q77.com/>
<div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
<header class="relative z-10 flex items-center justify-between flex-none px-2">
<form class="flex items-center flex-auto min-w-0">
<div class="flex items-center justify-center w-8 h-8 text-neutral-400">
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
</div>
<input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0>
</form>
<button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="閉じる (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
</button>
</header>
<section class="flex-auto px-2 overflow-auto">
<ul id=search-results>
</ul>
</section>
</div>
</div>
</div>
</body>
</html>